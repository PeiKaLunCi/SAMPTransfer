model:
  arch: conv4
  lr: 1e-3
  data_path: /home/nfs/oshirekar/unsupervised_ml/data/miniImageNetFullSize/train
  img_orig_size: [ 224, 224 ]
  batch_size: 4
  num_workers: 0
  mpnn_opts:
    _use: False
    mpnn_dev: cpu
    scaling_ce: 1
    adapt: task
    temperature: 0.2
    output_train_gnn: plain
    graph_params:
      sim_type: "correlation"
      thresh: "no" #0
      set_negative: "hard"
    gnn_params:
      pretrained_path: "no"
      red: 1
      cat: 0
      every: 0
      gnn:
        num_layers: 1
        aggregator: "add"
        num_heads: 1
        attention: "dot"
        mlp: 1
        dropout_mlp: 0.1
        norm1: 1
        norm2: 1
        res1: 1
        res2: 1
        dropout_1: 0.1
        dropout_2: 0.1
        mult_attr: 0
      classifier:
        neck: 1
        num_classes: 0
        dropout_p: 0.4
        use_batchnorm: 0

trainer:
  fast_dev_run: False
  max_epochs: 90
  logger:
    class_path: pytorch_lightning.loggers.WandbLogger
    init_args:
      project: SWaV
      save_dir: wandb_logs
      log_model: True
      name: ${oc.env:SLURM_JOB_ID}
  callbacks:
    - class_path: pytorch_lightning.callbacks.model_summary.ModelSummary
      init_args:
        max_depth: 3
    - class_path: pytorch_lightning.callbacks.ModelCheckpoint
      init_args:
        dirpath: ./ckpts/${oc.env:SLURM_JOB_ID}
        filename: "{epoch}-{step}-{val_loss:.2f}-{val_accuracy:.3f}-{train_accuracy_epoch:.3f}"
        monitor: loss_epoch
        save_last: True
        save_top_k: 1
        mode: min
    - class_path: pytorch_lightning.callbacks.LearningRateMonitor
      init_args:
        logging_interval: step